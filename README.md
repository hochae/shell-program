# shell-program
for additional information

## 환경 설정

### 배포 자료

| file name | 설명 |
| :--- | :---|
| **01.VirtualBox-5.2.26.zip** | VirtualBox 5.2.26, 교재내용, win10 에서만 동작 |
| **01.VirtualBox-7.1.4.zip** | VirtualBox 7.1.4, win10/11 |
| **02.Ubuntu-16.04_190622a.zip** | Ubuntu 16.04 image file |
| **03.Resources_201003a.zip** | 수업용 자료 |
| **04.Test_Image_ISO.zip** | 수업용 image file |

### [Ubuntu Desktop 환경 설정](./ubuntu_desktop.md)
목적: 교재에서 VirtualBox(VB) 5.2.26을 기반으로 설명하고 있지만 수업은 VB 7.1.4를 기반으로 진행한다. 따라서 추후 참고할 자료가 필요한 경우를 위해 정리한다.

## [vimrc setting](vimrc.md)
```vim
set nu

set showcmd             " 명령어 표시
set wildmenu            " 명령행 자동완성

" 들여쓰기 및 탭 설정
" set autoindent          " 자동 들여쓰기
" set smartindent         " 스마트 들여쓰기
" set cindent             " C언어 스타일 들여쓰기
" set tabstop=4           " 탭 크기
" set shiftwidth=4        " 자동 들여쓰기 크기
" set expandtab           " 탭을 스페이스로 변환
" set smarttab            " 스마트 탭
```

## man

### 리눅스 `man` 페이지 섹션

| 섹션 # | 설명 | 주요 내용 | 예시 명령어 또는 파일 |
| :--- | :--- | :--- | :--- |
| **1** | **실행 가능한 명령어** | 셸에서 직접 실행할 수 있는 일반적인 명령어 | `ls`, `grep`, `cd` |
| **2** | **시스템 호출** | 운영체제의 핵심 기능인 커널 시스템 호출 | `open`, `read`, `write` |
| **3** | **라이브러리 함수** | 프로그래밍(주로 C 언어)에 사용되는 라이브러리 함수 | `printf`, `malloc`, `memset` |
| **4** | **특수 파일** | 장치 파일, 드라이버 등 `/dev` 디렉터리의 파일 | `tty`, `random` |
| **5** | **파일 형식** | 시스템 설정 파일의 형식 및 규칙 | `passwd`, `fstab`, `resolv.conf` |
| **6** | **게임** | 시스템에 설치된 게임 프로그램 | `fortune` |
| **7** | **기타** | 다양한 주제, 관습, 표준 및 프로토콜 | `man`, `symlinks` |
| **8** | **시스템 관리 명령어** | 관리자 권한이 필요한 시스템 관리 도구 | `mount`, `ifconfig`, `fdisk` |

## ELF

ELF는 **Executable and Linkable Format**의 약자입니다.

ELF 파일은 Linux와 같은 Unix 계열 운영체제에서 사용되는 **실행 가능한 파일 형식**입니다. 컴파일된 프로그램, 공유 라이브러리, 커널 모듈 등이 모두 ELF 형식으로 되어 있습니다.

### ELF 파일의 역할

ELF 파일은 운영체제가 프로그램을 실행하는 데 필요한 모든 정보를 구조적으로 제공합니다. `ldd` 명령어로 공유 라이브러리 의존성을 확인하거나, `objdump` 명령어로 ELF 파일의 내부를 분석할 수 있습니다.

ELF 파일은 이진 파일로, 사람이 직접 읽을 수는 없습니다. 대신, 리눅스 시스템에서 제공하는 다양한 도구들을 사용하여 내부 정보를 분석해야 합니다.

### ELF 파일의 세 가지 유형

* **Relocatable File (재배치 가능 파일)**: 다른 파일과 링크될 수 있는 오브젝트 파일(`.o`)
* **Executable File (실행 파일)**: 운영체제에서 직접 실행될 수 있는 프로그램 파일
* **Shared Object File (공유 오브젝트 파일)**: 동적으로 로드될 수 있는 라이브러리 파일(`.so`)

---

### ELF 파일의 내부 구성 요소

* **ELF Header**: 파일의 가장 앞에 위치하며, 파일의 유형(실행 파일, 라이브러리 등), 아키텍처(x86, ARM 등), 엔디안(endianness) 등 파일 자체에 대한 기본적인 정보를 담고 있다.
* **Program Header Table**: 실행 파일에만 존재하며, 프로그램을 메모리에 로드하는 데 필요한 정보를 담고 있다. 예를 들어, 어떤 섹션을 메모리의 어느 주소에 로드해야 하는지 등을 명시.
* **Section Header Table**: ELF 파일의 모든 섹션에 대한 정보: 각 섹션의 이름, 크기, 위치, 권한 등을 정의.
* **Sections**: 실제 데이터가 저장되는 부분
  * `.text`: 프로그램의 실행 가능한 기계어 코드 저장
  * `.data`: 초기화된 전역 변수와 정적 변수 저장
  * `.bss`: 초기화되지 않은 전역 변수와 정적 변수 저장. 프로그램이 로드시 0으로 초기화.
  * `.rodata`: 읽기 전용 데이터(예: 문자열 리터럴) 저장
  * `.symtab`: 프로그램에 사용된 모든 심볼(함수, 변수 이름)에 대한 정보. 디버깅에 유용.
  * `.strtab`: `.symtab`에서 사용하는 심볼 이름 문자열 저장

---

### ELF 파일 분석 도구

다음은 ELF 파일을 읽고 분석하는 데 사용되는 주요 명령어들입니다.

* **`file`**: 파일의 기본적인 정보를 확인합니다. ELF 파일인지, 어떤 아키텍처(32비트/64비트, x86/ARM)용인지 등을 려줍니다.

  ```bash
  file /bin/ls
  ```

* **`readelf`**: ELF 파일의 상세한 정보를 분석합니다. 헤더, 섹션, 심볼 테이블 등 ELF 파일의 모든 구조를 확인할 수 습니다.

  ```bash
  readelf -h /bin/ls  # ELF 헤더 정보 확인
  readelf -S /bin/ls  # 섹션 헤더 테이블 확인
  readelf -s /bin/ls  # 심볼 테이블 확인
  ```

* **`objdump`**: ELF 파일의 기계어 코드와 섹션 정보를 더 상세하게 보여줍니다. 프로그램을 역어셈블(disassemble)여 사람이 읽을 수 있는 어셈블리 코드로 변환하는 데 유용합니다.

  ```bash
  objdump -d /bin/ls  # .text 섹션 역어셈블
  ```

* **`ldd`**: ELF 실행 파일이 동적으로 링크하는 공유 라이브러리 목록을 보여줍니다.

  ```bash
  ldd /bin/ls
  ```

## process status: STAT

ps ax 명령의 결과에 나타나는 **STAT** 항목의 내용이 각각 의미하는 바를 표로 정리해 드립니다. STAT는 **프로세스 상태 코드(process state codes)**를 나타내며, 각 문자는 프로세스의 현재 상태를 의미합니다.

---

### 프로세스 상태 코드

| 상태 코드 | 의미 | 설명 |
| :--- | :--- | :--- |
| **D** | **Disk Sleep** | 입출력(I/O) 작업을 기다리며 방해받지 않는(uninterruptible) 수면 상태에 있는 프로세스. |
| **I** | **Idle** | 방해받지 않는 수면 상태, 일반적으로 장치가 깨어나기를 기다리는 프로세스. |
| **R** | **Running** | 현재 CPU에서 실행 중이거나 실행을 위해 대기열에서 기다리는 프로세스. |
| **S** | **Interruptible Sleep** | 이벤트를 기다리며 잠들어 있는 상태. 시그널을 통해 깨어날 수 있습니다. |
| **T** | **Stopped** | 작업 제어 시그널(`Ctrl+Z`)이나 디버거에 의해 일시 정지된 프로세스. |
| **t** | **Traced** | `gdb`와 같은 도구에 의해 추적 또는 디버깅 중인 상태. |
| **Z** | **Zombie** | 종료되었지만 부모 프로세스가 아직 종료 상태를 수집하지 않아 시스템에 남아 있는 프로세스. |
| **X** | **Dead** | 종료 중인 상태에 있는 프로세스. |

---

### 추가 수정자(Modifier)

일부 상태 코드에는 추가적인 의미를 부여하는 문자가 붙을 수 있습니다.

| 수정자 | 의미 | 설명 |
| :--- | :--- | :--- |
| **<** | **높은 우선순위** | 사용자(`nice -n -20`)가 높은 우선순위를 설정한 프로세스. |
| **N** | **낮은 우선순위** | 우선순위가 낮은 프로세스. |
| **L** | **메모리 고정** | `mlock`과 같이 메모리 페이지가 잠겨있는 프로세스. |
| **s** | **세션 리더** | 해당 프로세스가 세션의 리더임을 나타냄. |
| **+** | **포그라운드 프로세스** | 터미널의 포그라운드 프로세스 그룹에 속함. |
| **l** | **멀티스레드** | 해당 프로세스가 멀티스레드임을 나타냄. |

## shell options: example
shopt 를 이용하여 아래와 같은 기능을 활성화 할 수 있다.

| 옵션 이름 | 설명 |
| :--- | :--- |
| **`autocd`** | 디렉터리 이름만 입력해도 자동으로 `cd` 명령어를 실행합니다. 예를 들어, 현재 위치에서 `documents`를 입력하면 `cd documents`를 실행합니다. |
| **`cdspell`** | `cd` 명령어를 입력할 때 디렉터리 이름의 철자가 틀리면 Bash가 비슷한 이름을 가진 디렉터리를 찾아 자동으로 이동을 시도합니다. |
| **`dotglob`** | 와일드카드 문자 `*`가 숨김 파일(파일 이름이 `.`으로 시작하는 파일)을 포함하도록 합니다. 이 옵션을 켜면 `ls *`만으로도 숨김 파일 목록을 볼 수 있습니다. |
| **`extglob`** | 확장된 패턴 일치 기능을 활성화합니다. 예를 들어 `!(file)`과 같은 패턴을 사용하여 특정 파일이나 디렉터리를 제외할 수 있습니다. |
| **`globstar`** | 와일드카드 `**`를 사용하여 모든 하위 디렉터리까지 파일을 재귀적으로 검색할 수 있습니다. 예를 들어 `ls **/*.log`는 현재 디렉터리의 모든 `.log` 파일을 찾습니다. |
| **`histappend`** | 쉘을 종료할 때 히스토리 기록을 덮어쓰지 않고 기존 파일에 추가합니다. 여러 터미널 세션을 사용하는 경우 유용합니다. |
| **`nocaseglob`** | 와일드카드(`*`, `?`)를 사용할 때 대소문자를 구분하지 않고 파일을 찾습니다. 예를 들어 `ls *.txt`가 `file.TXT`도 찾습니다. |
| **`nullglob`** | 와일드카드 패턴과 일치하는 파일이 없을 때 오류를 내는 대신 빈 문자열로 확장되도록 합니다. |


## find -size +1M 에 대한 실험 결과( 현동일 님 )
```txt
find -size 옵션에서 M단위를 사용할 경우,
round up (ceil)되는 것 같습니다.
다만 기준값과 크기비교시
이상 (equal or larger)이 아닌 초과 (larger)로 처리되기 때문에
~ 1M까지는 파일 크기가 1이 되고
이는 1을 초과하지 못하기 때문에
해당 조건을 만족하지 못하게 됩니다.

1048576B의 파일의 경우 -size +1M 적용시 기준 값보다 크지 않기 때문에 결과에 출력되지 않으며
1B 큰 1048577B 파일의 경우 -size +1M 적용시 결과로 출력되는 것을 확인했습니다.
```
